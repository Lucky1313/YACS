{# This template partial is used in course_list and department_list #}
{% load courses %}

<div id="selected" class="tableview">
<h2><a name="selected">Selected Courses</a></h2>
{% if selected_courses %}
	<form action="{% url deselect-courses sem_year,sem_month %}" method="post">
		{% csrf_token %}
		<ul id="selected_courses">
			{% for course in selected_courses %}
			{% with seats_left_for_course=course|seats_left_for_course:selected_sections %}
			<li class="course">
				<input type="checkbox" id="selected_course_{{ course.id }}" name="selected_course_{{ course.id }}" checked="checked" data-cid="{{ course.id }}" />
				<label for="selected_course_{{ course.id }}">
					<span class="name">{{ course.name }}</span>
					<span class="code">
						<span class="department">{{ course.department.code }}</span>
						<span class="course_number">{{ course.number }}</span>
					</span>
					<span class="credits">
						{% if course.credits_display != '4 credits' %}
						{{ course.credits_display }}
						{% endif %}
					</span>
					<span class="seats-left">
						<span class="number">{{ seats_left_for_course }}</span> seats left
					</span>
				</label>
				<span class="sections">
					{% with sections=selected_sections|sections_for:course %}
						{% if sections %}
							<ul>
								{% for section in sections %}
									<li class="section{% if section.is_full %} full{% endif %}">
										<input type="checkbox" id="selected_course_{{ course.id }}_{{ section.crn }}" name="selected_course_{{ course.id }}_{{ section.crn }}"{% if not section.is_full %} checked="checked"{% endif %} data-cid="{{ course.id }}" data-crn="{{ section.crn }}" />
										<label for="selected_course_{{ course.id }}_{{ section.crn }}">
											<span class="section-number">
												Section <span class="number">{{ section.number }}</span>
											</span>
											(<span class="crn">{{ section.crn }}</span>) -
											{% if not section.is_full %}
											<span class="section-seats-left">
												<span class="number">{{ section.seats_left }}</span> seat{{ section.seats_left|pluralize }} left
											</span>
											{% else %}
											<span class="section-seats-left none">
											No seats left
											</span>
											{% endif %}
										</label>
									</li>
								{% endfor %}
							</ul>
						{% else %}
							There are no listed sections.
						{% endif %}
					{% endwith %}
				</span>
			</li>
			{% endwith %}
			{% endfor %}
		</ul>
		<p class="total_credits">{{ selected_courses|sum_credits }} total</p>
		<p class="actions">
			<input type="hidden" name="redirect_to" value="{{ request.get_full_path }}" />
			<input type="submit" class="save-selected" value="Save" />
			<a href="{% url schedules sem_year,sem_month %}" class="button">View Schedules</a>
		</p>
	</form>
{% else %}
	<p>No selected courses</p>
{% endif %}
</div>

<script type="text/template" id="selected-course-template">
	<input type="checkbox" id="selected_course_<%- id %>" name="selected_course_<%- id %>" checked="checked" />
	<label for="selected_course_<%- id %>">
		<span class="name"><%- name %></span>
		<span class="code">
			<span class="department"><%- department.get('code') %></span>
			<span class="course_number"><%- number %></span>
		</span>
		<span class="credits">
			<%- (credits !== '4 credits') ? '' : credits %>
		</span>
		<span class="seats-left">
			<span class="number"><%- seats_left %></span> seat<%- (seats_left === 1) ? '' : 's' %> left
		</span>
	</label>
	<span class="sections">
	<ul>
	</ul>
	</span>
</script>

<script type="text/template" id="selected-section-template">
	<input type="checkbox" id="selected_course_<%- course.id %>_<%- crn %>" name="selected_course_<%- course.id %>_<%- crn %>" <%= marked ? 'checked="checked"' : '' %> />
	<label for="selected_course_<%- course.id %>_<%- crn %>">
		<span class="section-number">
			Section <span class="number"><%- number %></span>
		</span>
		(<span class="crn"><%- crn %></span>) -
		<% if (seats_left > 0) { %>
		<span class="section-seats-left">
			<span class="number"><%- seats_left %></span>
			seat<%- seats_left !== 1 ? 's' : '' %> left
		</span>
		<% } else { %>
		<span class="section-seats-left none">
		No seats lefts
		</span>
		<% } %>
	</label>
</script>
