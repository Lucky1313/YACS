{% extends 'site_base.html' %}

{% load courses %}

{% block title %}Selected Courses | {% endblock %}

{% block head %}
<meta name="robots" content="NOINDEX, FOLLOW">
{{ block.super }}
{% endblock %}

{% block header %}
{{ block.super }}
{% include '_nav.html' with selected='selected' %}
{% endblock header %}

{% block content %}
<div id="courses" class="listview">
	<form action="{% url deselect-courses sem_year,sem_month %}" method="post">
		{% csrf_token %}
		<ul id="selected_courses">
		</ul>
		<p class="total_credits"></p>
	</form>
</div>

{# functions: #}
{# required context: #}
<script type="text/template" id="selected-course-template">
<li class="course <%- course.seats_left < 1 ? 'no-seats' : ''; %><%- course.crns.length < 1 ? 'no-sections' : ''; %>">
    <% if (course.crns.length > 0){ %>
        <input type="checkbox" id="selected_course_<%- course.id %>" name="course_<%- course.id %>"
    <% if (course.is_selected){ %> checked="checked" <% } %>
        data-cid="<%- course.id %>" data-crns="<%- course.crns.join(', '); %>" data-crns-full="<%- course.full_crns.join(', ') %>" />
    <% } else { %>
        <p style="float:left; width: 15px; height: 10px; margin: 0; padding: 0;"></p>
    <% } %>
    <label class="padded" for="selected_course_<%- course.id %>">
        <span class="name"><%- course.name %></span>
        <span class="secondary">
            <span class="code">
                <span class="dept"><%- course.department.code %></span>
                <span class="number"><%- course.number %></span>
            </span>
            <span class="credits">
                <%- course.credits_display %>
            </span>
            <span class="seats-left">
                <% if (course.crns.length > 0){ %>
                    <% if (course.seats_left < 30) { %>
                        <%- course.seats_left %> seat<%- course.seats_left === 1 ? '' : 's' %> left
                    <% } %>
                <% } else { %>
                    No Sections
                <% } %>
            </span>
            <div class="kinds">
                <ul>
                    <% course.kinds.each(function(kind){ %>
                        <li><%- kind %></li>
                    <% }); %>
                </ul>
            </div>
            <div class="notes">
                <ul>
                    <% course.notes.each(function(note){ %>
                        <li><%- note %><li>
                    <% }); %>
                </ul>
            </div>
        </span>
    </label>
    <% if (always_show_sections){ %>
    <span class="sections">
        <% if(course.sections){ %>
            <ul>
                <% course.sections.each(function(section){ %>
                    <li class="section<%- section.is_full ? 'full' : ''; %>">
                        <input type="checkbox" id="selected_course_<%- course.id %>_<%- section.crn %>" name="selected_course_{{ course.id }}_{{ section.crn }}"{% if section.crn in selected_section_ids %} checked="checked"{% endif %} data-cid="{{ course.id }}" data-crn="{{ section.crn }}" />
                        <label for="selected_course_<%- course.id %>_<%- section.crn %>">
                            <span class="section-number">
                                Section <span class="number"><%- section.number %></span>
                            </span>
                            <% if (!section.is_full) { %>
                            <span class="section-seats-left">
                                <span class="number"><%- section.seats_left %></span> seat<%- section.seats_left === 1 ? '' : 's' %> left
                            </span>
                            <% } else { %>
                            <span class="section-seats-left none">No seats left</span>
                            <% } %>
                            <div class="instructors">
                                <ul>
                                    <% section.instructors.each(function(instructor){ %>
                                    <li><%- instructor %></li>
                                    <% });
                                </ul>
                            </div>
                        </label>
                        <ul class="days">
                            <% var times = section.get_periods %>
                            <% dows.each(function(dow){ %>
                            <li class="item <%- times[dow] ? 'selected' : 'empty' %>">
                                <span class="short"><%- dow %></span>
                                <span class="long"><%- dow %></span>
                                <ul class="times">
                                    <% times[dow].each(function(){ %>
                                        <li><%- display_period(period) %></li>
                                    <% } %>
                                </ul>
                            </li>
                            <% } %>
                        </ul>
                    </li>
                <% }); %>
            </ul>
        <% } else { %>
            There are no listed sections.
        <% } %>
    </span>
    <% } %>
    <div class="clear"></div>
</li>
</script>

<script type="text/template" id="no-selected-courses-template">
<div class="empty">
    <h3 class="text-center">...</h3>
    <p>Here would be any courses you selected... <br/>if only you picked out some courses.</p>
    <p>
        Checking courses from the <a href="{% url departments sem_year,sem_month %}">catalog</a>
        will show up here.
    </p>
</div>
</script>
{% endblock content %}

{% block sidebar %}
{% endblock sidebar %}
